name: Pandoc

on:
  push:
    branches: [scala3-pandoc]

jobs:
  printenv:
    runs-on: ubuntu-latest

    steps:
      - name: Print environment
        run: |
          env | grep HOME

  setenv:
    needs: printenv
    runs-on: ubuntu-latest

    steps:
      - name: Set up Pandoc
        uses: docker://pandoc/latex:latest

      - name: Check environment setup
        run: |
          docker version --format '{{.Server.Version}}'
          docker run pandoc/latex:latest --version | grep ^pandoc
          env | grep DOCKER

  build:
    needs: setenv
    runs-on: ubuntu-latest
    #if: "(    github.event_name == 'pull_request'
    #       && !contains(github.event.pull_request.body, '[skip ci]')
    #       && !contains(github.event.pull_request.body, '[skip docs]')
    #     )
    #     || contains(github.event.ref, 'pandoc')
    #     || contains(github.event.ref, 'master')"

    steps:
      - name: Git Checkout
        uses: actions/checkout@v2

      - name: Generate PDF reference documentation
        run: |
          echo chmod +x ./pandoc/md2pdf
          echo ./pandoc/md2pdf reference
